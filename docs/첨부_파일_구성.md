# Molecular Descriptor Toolkit (MDT) - ì²¨ë¶€ íŒŒì¼ êµ¬ì„±

ì²¨ë¶€í•œ íŒŒì¼ êµ¬ì„±ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

---

## íŒŒì¼ êµ¬ì¡°

```
descriptor-toolkit/
â”œâ”€â”€ ğŸ“ docs/                          # ë¬¸ì„œ
â”‚   â”œâ”€â”€ í”„ë¡œê·¸ë¨_êµ¬ë™ë°©ë²•.md           # í”„ë¡œê·¸ë¨ ì‚¬ìš© ê°€ì´ë“œ
â”‚   â””â”€â”€ ì²¨ë¶€_íŒŒì¼_êµ¬ì„±.md              # ë³¸ ë¬¸ì„œ
â”‚
â”œâ”€â”€ ğŸ“ molecular_descriptor_toolkit/   # ë©”ì¸ íŒ¨í‚¤ì§€
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cli.py                         # CLI ì§„ì…ì 
â”‚   â”œâ”€â”€ ğŸ“ config/                     # ì„¤ì • ê´€ë¦¬
â”‚   â”œâ”€â”€ ğŸ“ filtering/                  # í•„í„°ë§ íŒŒì´í”„ë¼ì¸
â”‚   â”œâ”€â”€ ğŸ“ preprocessing/              # ì „ì²˜ë¦¬ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ ğŸ“ ml/                         # ML í•™ìŠµ ëª¨ë“ˆ
â”‚   â””â”€â”€ ğŸ“ workflows/                  # ì›Œí¬í”Œë¡œìš°
â”‚
â”œâ”€â”€ ğŸ“ reference/                      # ì°¸ì¡° ê²°ê³¼ (ì›¹ ì‹¤í—˜)
â”‚   â”œâ”€â”€ FINAL_REPORT.md               # ì‹¤í—˜ ë³´ê³ ì„œ
â”‚   â”œâ”€â”€ train_samples_61.csv          # í•™ìŠµ ë°ì´í„° (61ê°œ)
â”‚   â”œâ”€â”€ test_samples_16.csv           # í…ŒìŠ¤íŠ¸ ë°ì´í„° (16ê°œ)
â”‚   â””â”€â”€ *.csv, *.png                  # ê²°ê³¼ íŒŒì¼ë“¤
â”‚
â”œâ”€â”€ setup.py                          # íŒ¨í‚¤ì§€ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ requirements.txt                  # ì˜ì¡´ì„± ëª©ë¡
â”œâ”€â”€ CLAUDE.md                         # í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
â””â”€â”€ README.md                         # í”„ë¡œì íŠ¸ ì†Œê°œ
```

---

## ìƒì„¸ íŒŒì¼ ì„¤ëª…

### 00. ë¬¸ì„œ

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `docs/í”„ë¡œê·¸ë¨_êµ¬ë™ë°©ë²•.md` | í”„ë¡œê·¸ë¨ ì„¤ì¹˜ ë° ì‹¤í–‰ ë°©ë²• ìƒì„¸ ê°€ì´ë“œ |
| `docs/ì²¨ë¶€_íŒŒì¼_êµ¬ì„±.md` | ì²¨ë¶€ íŒŒì¼ êµ¬ì„± ì„¤ëª… (ë³¸ ë¬¸ì„œ) |
| `CLAUDE.md` | í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ ë° ê°œë°œ ì´ë ¥ |
| `README.md` | í”„ë¡œì íŠ¸ ê°œìš” |

---

### 01. Environment (í™˜ê²½ ì„¤ì •)

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `setup.py` | íŒ¨í‚¤ì§€ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ (`pip install -e .` ì‚¬ìš©) |
| `requirements.txt` | Python ì˜ì¡´ì„± ëª©ë¡ |

**ì£¼ìš” ì˜ì¡´ì„±:**
- `numpy>=1.24.0` - ìˆ˜ì¹˜ ì—°ì‚°
- `pandas>=2.0.0` - ë°ì´í„° ì²˜ë¦¬
- `pyarrow>=12.0.0` - Parquet íŒŒì¼ I/O
- `torch>=2.0.0` - GPU ê°€ì† (ì„ íƒ)
- `rdkit>=2023.3.1` - ë¶„ì ì²˜ë¦¬
- `mordred>=1.2.0` - Descriptor ê³„ì‚°
- `scikit-learn>=1.3.0` - ML ì•Œê³ ë¦¬ì¦˜
- `xgboost`, `lightgbm` - ë¶€ìŠ¤íŒ… ëª¨ë¸ (ì„ íƒ)

**ì„¤ì¹˜ ë°©ë²•:**
```bash
pip install -e .
```

---

### 02. Code (ì½”ë“œ)

#### 2.1 ë©”ì¸ íŒ¨í‚¤ì§€ (`molecular_descriptor_toolkit/`)

| íŒŒì¼/í´ë” | ì„¤ëª… |
|-----------|------|
| `cli.py` | ëª…ë ¹ì¤„ ì¸í„°í˜ì´ìŠ¤ (CLI) ì§„ì…ì  |
| `config/` | ì„¤ì • í´ë˜ìŠ¤ ì •ì˜ (DeviceConfig, IOConfig ë“±) |
| `filtering/` | 4ë‹¨ê³„ í•„í„°ë§ íŒŒì´í”„ë¼ì¸ êµ¬í˜„ |
| `preprocessing/` | ë°ì´í„° ì „ì²˜ë¦¬ (XML íŒŒì‹±, Descriptor ê³„ì‚°) |
| `ml/` | ML ëª¨ë¸ í•™ìŠµ ëª¨ë“ˆ |
| `workflows/` | í†µí•© ì›Œí¬í”Œë¡œìš° |

#### 2.2 í•„í„°ë§ íŒŒì´í”„ë¼ì¸ (`filtering/`)

| ëª¨ë“ˆ | ì„¤ëª… |
|------|------|
| `pipeline.py` | ë©”ì¸ íŒŒì´í”„ë¼ì¸ í´ë˜ìŠ¤ |
| `passes/pass0_sampling.py` | Pass 0: ë°ì´í„° ìƒ˜í”Œë§ |
| `passes/pass1_statistics.py` | Pass 1: í†µê³„ ë° ë¶„ì‚° í•„í„°ë§ |
| `passes/pass2_spearman.py` | Pass 2: Spearman ìƒê´€ ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ë§ |
| `passes/pass3_vif.py` | Pass 3: VIF ë‹¤ì¤‘ê³µì„ ì„± í•„í„°ë§ |
| `passes/pass4_nonlinear.py` | Pass 4: HSIC/RDC ë¹„ì„ í˜• ìƒê´€ í•„í„°ë§ |

#### 2.3 ML ëª¨ë“ˆ (`ml/`)

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `ensemble.py` | OptimalMLEnsemble í´ë˜ìŠ¤ - 8ê°œ ëª¨ë¸ ì•™ìƒë¸” í•™ìŠµ |

**ì§€ì› ëª¨ë¸:**
- RandomForest, ExtraTrees (íŠ¸ë¦¬ ê¸°ë°˜)
- XGBoost, LightGBM (ë¶€ìŠ¤íŒ…)
- Ridge, Lasso, ElasticNet (ì„ í˜•)
- GPR (ê°€ìš°ì‹œì•ˆ í”„ë¡œì„¸ìŠ¤)

---

### 03. Data (ë°ì´í„°)

#### 3.1 ì…ë ¥ ë°ì´í„° í˜•ì‹

| í˜•ì‹ | í™•ì¥ì | ì„¤ëª… |
|------|--------|------|
| CSV | `.csv` | SMILES ì»¬ëŸ¼ í¬í•¨ |
| Parquet | `.parquet` | SMILES ë˜ëŠ” Descriptor í¬í•¨ |
| PubChem XML | `.xml`, `.xml.gz` | PubChem ë‹¤ìš´ë¡œë“œ í˜•ì‹ |

**í•„ìˆ˜ ì»¬ëŸ¼:**
- `SMILES` ë˜ëŠ” `standardized_smiles`: ë¶„ì êµ¬ì¡°
- `CID` ë˜ëŠ” `id`: ë¶„ì ì‹ë³„ì

#### 3.2 ë¼ë²¨ ë°ì´í„° (ML í•™ìŠµìš©)

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `Labeled_descriptors.parquet` | ë¼ë²¨(pLeach)ì´ í¬í•¨ëœ descriptor ë°ì´í„° |

**ì˜ˆì‹œ ì»¬ëŸ¼:**
- `CID`: ë¶„ì ID
- `pLeach`: íƒ€ê²Ÿ ë³€ìˆ˜ (ì˜ˆì¸¡ ëŒ€ìƒ)
- `AATS0Z`, `AATS0are`, ...: Descriptor ì»¬ëŸ¼ë“¤

---

### 04. Reference (ì°¸ì¡° ê²°ê³¼)

ì´ì „ ì›¹ ì‹¤í—˜ì˜ ê²°ê³¼ íŒŒì¼ë“¤ì…ë‹ˆë‹¤.

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `FINAL_REPORT.md` | ì¢…í•© ì‹¤í—˜ ë³´ê³ ì„œ |
| `model_comparison_results.csv` | ëª¨ë¸ë³„ ì„±ëŠ¥ ë¹„êµ |
| `best_configurations.csv` | ìƒìœ„ 20ê°œ ìµœì  ì„¤ì • |
| `detailed_summary_stats.csv` | ìƒì„¸ í†µê³„ |
| `train_samples_61.csv` | í•™ìŠµ ë°ì´í„° (61ê°œ ìƒ˜í”Œ) |
| `test_samples_16.csv` | í…ŒìŠ¤íŠ¸ ë°ì´í„° (16ê°œ ìƒ˜í”Œ) |
| `comprehensive_analysis.png` | ì¢…í•© ë¶„ì„ ì‹œê°í™” |

**í•µì‹¬ ê²°ê³¼:**
- ìµœì  ëª¨ë¸: **XGBoost with 30 Descriptors**
- Hold-Out RÂ²: **0.7822**
- ê·¹ë‹¨ê°’ MAE: **1.45**

---

### 05. Output (ì¶œë ¥ ê²°ê³¼)

í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹œ ìƒì„±ë˜ëŠ” ì¶œë ¥ íŒŒì¼ë“¤ì…ë‹ˆë‹¤.

#### 5.1 Track 1 ì¶œë ¥ (í•„í„°ë§)

```
outputs/
â”œâ”€â”€ pass0_sample.parquet          # ìƒ˜í”Œë§ëœ ë°ì´í„°
â”œâ”€â”€ pass1_statistics.json         # í†µê³„ ì •ë³´
â”œâ”€â”€ pass1_removed.json            # ì œê±°ëœ descriptor
â”œâ”€â”€ pass2_spearman_clusters.json  # Spearman í´ëŸ¬ìŠ¤í„°
â”œâ”€â”€ pass3_vif_results.json        # VIF ê²°ê³¼
â”œâ”€â”€ pass4_nonlinear_results.json  # ë¹„ì„ í˜• ê²°ê³¼
â”œâ”€â”€ final_descriptors.json        # ìµœì¢… descriptor ëª©ë¡
â”œâ”€â”€ final_cluster_info.json       # í´ëŸ¬ìŠ¤í„° ì •ë³´ (MLìš©)
â””â”€â”€ pipeline_summary.json         # íŒŒì´í”„ë¼ì¸ ìš”ì•½
```

#### 5.2 Track 2 ì¶œë ¥ (ML í•™ìŠµ)

```
ml_output/
â”œâ”€â”€ ml_results.json               # ì „ì²´ ì‹¤í—˜ ê²°ê³¼
â”œâ”€â”€ best_model.json               # ìµœê³  ëª¨ë¸ ì •ë³´
â”œâ”€â”€ model_comparison_test_r2.png  # ëª¨ë¸ ë¹„êµ ê·¸ë˜í”„
â”œâ”€â”€ kfold_vs_holdout.png          # CV vs Hold-out ë¹„êµ
â””â”€â”€ descriptor_count_heatmap.png  # ì„±ëŠ¥ íˆíŠ¸ë§µ
```

---

## ì£¼ìš” íŒŒì¼ ë‚´ìš© ì„¤ëª…

### `final_cluster_info.json` êµ¬ì¡°

```json
{
  "n_final_descriptors": 72,
  "n_total_clusters": 72,
  "descriptors": {
    "PEOE_VSA5": {
      "cluster_id": 0,
      "cluster_size": 15,
      "all_cluster_members": ["PEOE_VSA5", "SMR_VSA5", ...],
      "alternative_descriptors": ["SMR_VSA5", ...]
    },
    ...
  }
}
```

### `ml_results.json` êµ¬ì¡°

```json
[
  {
    "model_name": "XGBoost",
    "n_descriptors": 30,
    "kfold_r2_mean": 0.131,
    "kfold_r2_std": 0.33,
    "holdout_r2": 0.782,
    "holdout_rmse": 1.234,
    "overfitting_gap": -0.65,
    "extreme_high_mae": 1.45,
    "feature_importance": {...}
  },
  ...
]
```

---

## ë¹ ë¥¸ ì‹œì‘ ì˜ˆì œ

```bash
# 1. ì„¤ì¹˜
pip install -e .

# 2. Track 1: Descriptor ì¶”ì¶œ ë° í•„í„°ë§
mdt process-all \
    --input data/molecules.csv \
    --output-dir results/ \
    --smiles-col SMILES

# 3. Track 2: ML í•™ìŠµ
mdt train \
    --input Labeled_descriptors.parquet \
    --cluster-info results/outputs/final_cluster_info.json \
    --output-dir ml_results/

# 4. ê²°ê³¼ í™•ì¸
cat ml_results/best_model.json
```

---

## ë¬¸ì˜ ë° ì§€ì›

- GitHub Issues: [repository URL]
- Email: your.email@kaeri.re.kr
